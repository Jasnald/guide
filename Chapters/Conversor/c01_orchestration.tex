\section{Stage 1: Configuration and Orchestration}
\label{sec:conv_orchestration}

\textbf{Files:} \texttt{odb\_npz\_para.py}, \texttt{deps.py}

\subsection{Module Restructuring}

The conversor module was reorganised and all scripts renamed to follow a consistent lowercase-underscore convention:

\begin{table}[ht]
\centering
\begin{tabular}{ll}
\hline
\textbf{Old name} & \textbf{New name} \\
\hline
\texttt{Odb\_Npz\_Parameters.py} & \texttt{odb\_npz\_para.py} \\
\texttt{Odb\_Npz\_Converter.py}  & \texttt{odb\_npz\_conv.py} \\
\texttt{Npy\_2\_Xdmf.py}         & \texttt{npy\_hdf\_conv.py} \\
--- (new)                        & \texttt{deps.py} \\
\hline
\end{tabular}
\caption{Conversor module file renaming.}
\end{table}

\subsection{deps.py --- Centralised Imports}

All imports for the conversor package are now consolidated in \texttt{deps.py}. This solves two problems from the old code: duplicate import blocks across files, and IDE false-positive errors from Abaqus-only symbols.

The file handles Python 2/3 compatibility explicitly:
\begin{itemize}
    \item \texttt{pathlib.Path} is imported with a \texttt{try/except} --- if the import fails (Python 2.7 Abaqus environment), \texttt{Path} is set to \texttt{None} so the rest of the code still runs.
    \item \texttt{scipy} and \texttt{h5py} are guarded the same way --- their absence does not crash the Abaqus side, which does not need them.
    \item NumPy warnings about files created on Python 2 are suppressed globally here, not in each consumer module.
\end{itemize}

\textbf{Where to change:} add any new third-party dependency import here, with the same \texttt{try/except} guard if it is Python-3-only.

\subsection{ODB2NPYParameters}

\texttt{ODB2NPYParameters} loads \texttt{data/config.json} and returns the ODB simulation directory, the NPY output directory, and the conversion parameters dict consumed by \texttt{OdbBatchConverter}. Responsibility is unchanged from the previous version.

A diagnostic block was added to \texttt{run()}: it logs Python version, current directory, root directory, and encoding before returning. This is useful when the script runs from Abaqus where the environment can differ from the development machine.

\subsection{OdbBatchConverter}

Finds all \texttt{.odb} files in \texttt{Simulation\_dir}, inspects their structure (steps, instances, frame counts), and calls \texttt{OdbToNPYConverter} for each one. One subdirectory per ODB file is created inside \texttt{NPY\_Dir}.

A new helper \texttt{\_convert\_frame\_params(begin\_frame, end\_frame)} was added to convert legacy \texttt{-1} sentinel values to the format expected by the new converter, keeping backward compatibility with existing configs.

\textbf{Where to change:}
\begin{itemize}
    \item \textbf{Process only specific ODB files:} modify \texttt{find\_odb\_files} or add a name filter before the loop in \texttt{convert\_batch}.
    \item \textbf{Change mesh type:} set \texttt{MeshType} in \texttt{config.json} under \texttt{conversion\_params/Contour\_Method} --- \texttt{"12"} for Hexahedron, \texttt{"10"} for Tetrahedron.
\end{itemize}