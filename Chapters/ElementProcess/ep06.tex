\section{Batch Processing Variant}
\label{sec:ep_batch_variant}

\textbf{Script:} \texttt{stress\_mapping\_2.py}

Extends \texttt{StressProcessor} to handle directory structures where multiple load cases (\texttt{S1}, \texttt{S2}, \ldots) share the same mesh geometry. Typical use case: RSA sensitivity analysis batches.

\subsection{Inheritance}

\texttt{StressProcessorBatch} subclasses \texttt{StressProcessor} via a relative import:

\begin{lstlisting}[language=Python]
from .stress_mapping import StressProcessor

class StressProcessorBatch(StressProcessor):
    # Overrides: find_simulations, process_specific_simulation,
    #            process_all_simulations
    # Inherits:  all HDF5 reading, KDTree mapping, and output methods
\end{lstlisting}

All mapping logic (HDF5 extraction, KDTree, output file generation) is inherited unchanged. Only discovery and per-case orchestration are overridden.

\subsection{Discovery Logic}

\texttt{find\_simulations} searches for two filename patterns:

\begin{table}[ht]
\centering
\begin{tabular}{ll}
\hline
\textbf{Pattern} & \textbf{Example} \\
\hline
\texttt{Mesh-*--Length-*.inp}    & \texttt{Mesh-0\_6--Length-50.inp} \\
\texttt{S*\_Mesh-*--Length-*.inp} & \texttt{S1\_Mesh-0\_6--Length-50.inp} \\
\hline
\end{tabular}
\caption{File patterns recognised by \texttt{StressProcessorBatch.find\_simulations}.}
\end{table}

The \texttt{S\textit{N}\_} prefix is stripped via regex (\texttt{r"\textasciicircum{}S\textbackslash{}d+\_(.+)\$"}) to obtain the normalised mesh name used as the dictionary key. Both naming conventions resolve to the same base mesh and share the same \texttt{elements\_data.txt}.

\subsection{Per-Case Output}

\texttt{process\_specific\_simulation} iterates all S* entries found in the HDF5 file for a given mesh base and writes a dedicated subdirectory per case:

\begin{verbatim}
Output/
  Mesh-0_6--Length-50/
    S1_Mesh-0_6--Length-50/
      stress_mapping_by_z.json
      stress_mapping_by_z.h5
      stress_input.txt
    S2_Mesh-0_6--Length-50/
      ...
\end{verbatim}

\subsection{Usage}

\begin{lstlisting}[language=Python]
from element_process.stress_mapping_2 import StressProcessorBatch

processor = StressProcessorBatch(
    base_dir="C:/Simulations/Residual_Stresses_Analysis"
)
results = processor.process_all_simulations(
    hdf5_folder="C:/Simulations/Contour_Method/xdmf_hdf5_files"
)
\end{lstlisting}